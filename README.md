# Working with files

## 🎯 Objectives

- ☑️ Read and write to files using the `fs` module
- ☑️ Use `uuid` (a third-party package) to generate unique ids
- ☑️ Serialize and deserialize data using the `JSON.parse` and `JSON.stringify` methods

## 💼 The brief

Chris wants to build an inspirational quotes app so his words of wisdom are never lost and easily accessible for future bootcampers. 😬

Your job isn't to build the entire app right now, but you will be coding the app's core functionality, ready to be imported and used/reused later.

The app will store a list of Chris's quotes in a JSON file. Each quote will have the following properties:

- id (String) - a unique id generated by the `uuid` package
- quoteText (String) - the quote contents/text

In this project, you'll build a total of five different helper functions which will enable the user to:

- Get all quotes
- Add/save a new quote
- Get a random quote
- Edit a quote
- Delete a quote

🚨 Requirement for project management: for each completed ticket, make a commit!

## 🎫 Ticket 1 - Getting familiar with the starter files

This project has already been initialized for you using the `npm init` command.

You'll notice the following files and folders already exist at the root of your project:

- `quote.js` - where the helper functions will be located
- `quotes.json` - where the list of quotes will be stored
- `.gitignore` - tells git what files to ignore
- `package.json` - where the project's dependencies are listed
- `package-lock.json` - a lock file that keeps track of the exact version of each package that you're using
- `__tests__` - where the automated tests are located
- `config.js` - where a `FILENAME` variable is initialised and exported
- `README.md` - where you're reading this now

We've initialized `quotes.json` with an empty array.

🧪 The `__tests__` folder in the root of your project should be left alone and ignored - it is to run tests that help you see if you're on the right track with your solutions.

Open the `package.json` file, and you'll notice the following dependencies:

- uuid - the package you'll use to generate unique ids
- jest - a package/devDependency which allows us to check your solutions with automated tests

Now would be an excellent time to **install** these **npm** packages and their dependencies - do you remember how to do that?

💡 In your `.gitignore` file, we've added "node_modules" as you don't want all those files being pushed up to GitHub. There is no need to track them in git, since all you need to do to gather all the node modules your project relies on is run `npm install` - this installs all of the dependencies listed in your `package.json` file.

If you try to run a project that has dependencies (that is, it depends on other modules to run) before running `npm install`, you'll simply get an error message similar to this:

```bash
Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'express' imported from /Users/me/my_project/app.js
    at packageResolve (node:internal/modules/esm/resolve:853:9)
    at moduleResolve (node:internal/modules/esm/resolve:910:20)
    at defaultResolve (node:internal/modules/esm/resolve:1130:11)
    at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:396:12)
    at ModuleLoader.resolve (node:internal/modules/esm/loader:365:25)
    at ModuleLoader.getModuleJob (node:internal/modules/esm/loader:240:38)
    at ModuleWrap.<anonymous> (node:internal/modules/esm/module_job:85:39)
    at link (node:internal/modules/esm/module_job:84:36) {
  code: 'ERR_MODULE_NOT_FOUND'
}
```

This simply means you imported the express module in your code, but when node looked for express it couldn't find it. No wonder... we haven't installed it yet.

Now is a good time to run `npm install` in the terminal and see that happen for yourself.

## 🎫 Ticket 2 - Creating functionality for quotes

### 🎫 Ticket 2a - Getting familiar with quotes.js

Open `quote.js`. In this file, a Native (core) module (`fs`) and a npm package (`uuid`) have already been imported.

```js
import fs from "node:fs/promises";
import { v4 as uuidv4 } from "uuid";
```

A `FILENAME` variable has been imported from `config.js`.

💡 As you may have already figured, `FILENAME` is the name of your JSON data file (where the quotes will be stored), which is declared as `quotes.json`.

### 🎫 Ticket 2b - Get all quotes

Inside `quote.js` find the `getQuotes` function.

The function should:

- not take in any arguments
- read/parse all quote objects from `FILENAME`
- return an array of all existing quote objects

🧪 This ticket has an automated test. Once you think your solution works run the following command:

```bash
npm run test-ticket-2b
```

If all tests pass, commit your work and move on to the next ticket. ✔️

### 🎫 Ticket 2c - Add a new quote

Inside `quote.js` find the `addQuote` function.

The function should:

- take in quoteText (String)
- create a quote object
- assign a unique id to the quote object (using a v4 uuid)
- read/parse all quote objects from the file that the `FILENAME` variable points to
- write to the `FILENAME file the array of quotes including the new quote object at the end of the array
- return the newly created quote object

💡 Here's an example of the quote object structure.

```js
{
  id: "949355ba-7916-441d-97b5-3ebd946da8c1",
  quoteText: "This is a quote"
}
```

🧪 This ticket has an automated test. Once you think your solution works run the following command:

```bash
npm run test-ticket-2c
```

If all tests pass, commit your work and move on to the next ticket. ✔️

### 🎫 Ticket 2d - Get a random quote

Inside `quote.js` find the `getRandomQuote` function.

The function should:

- not take in any arguments
- read/parse all quote objects from `FILENAME`
- return a single randomly selected quote object

🧪 This ticket has an automated test. Once you think your solution works run the following command:

```bash
npm run test-ticket-2d
```

If all tests pass, commit your work and move on to the next ticket. ✔️

### 🎫 Ticket 2e - Edit a quote

Inside `quote.js` find the `editQuote` function.

The function should:

- take in an `id` (String) as the 1st argument and `quoteText` (String) as the 2nd
- read/parse all quote objects from `FILENAME`
- find the existing quote object with a matching id
- update and save the matching quote object so that it contains the new `quoteText`
- return null if there is no matching id
- return the edited quote object if a matching id is found

🧪 This ticket has an automated test. Once you think your solution works run the following command:

```bash
npm run test-ticket-2e
```

If all tests pass, commit your work and move on to the next ticket. ✔️

### 🎫 Ticket 2f - Delete a quote

Inside `quote.js` find the `deleteQuote` function.

The function should:

- take in a single argument `id` (String)
- read/parse all quote objects from `FILENAME`
- find the existing quote object with a matching id
- remove the matching quote object
- save the new list of quote objects to `FILENAME`
- return null if there is no matching id
- return the deleted quote object if a matching id is found

🧪 This ticket has an automated test. Once you think your solution works run the following command:

```bash
npm run test-ticket-2f
```

If all tests pass - congratulations, you've finished! Commit your work and push it up to GitHub. ✔️

## 🥇 You've finished

🔍 Take another look at your code and see if you can refactor anything.

🧪 If you do make any changes while refactoring, you can run all tests at once using `npm run test`. `test` is such a common script that node lets you shortcut that, and you can do `npm test` or even `npm t`.

🚁 Once you've done that, you could check to see if fellow bootcampers need help.
